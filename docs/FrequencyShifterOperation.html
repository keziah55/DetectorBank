<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A Hopf, Skip and a Jump: FrequencyShifter: Internal Operation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A Hopf, Skip and a Jump
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classFrequencyShifter.html" title="Shift a signal by a given frequency. ">FrequencyShifter</a>: Internal Operation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section explains the internal workings of the <a class="el" href="classFrequencyShifter.html#a4719e771f5b74813f50978b1e4f46b0b">FrequencyShifter</a>.</p>
<p>It is well known that the maximum bandwidth (Nyquist rate) of a linear sampled system is half the sampling frequency. The nonlinear system used in this project could not be discretized, so numerical methods - central difference and fourth order Runge-Kutta - are employed to solve the differential equation. These approximations inevitably introduce errors. Normalisation (see <a class="el" href="classAbstractDetector.html#a00c532ce632f1819d2f7a78441d661ae">search normalisation</a>) can be used to improve the responses, but the maximum frequency that can be represented is still significantly lower than the Nyquist frequency of a linear system.</p>
<p>We use frequency shifting to extend the frequency range up to the Nyquist rate. For each combination of numerical method (central difference or Runge-Kutta) and normalisation (search normalised or unnormalised), a maximum frequency is defined. If the user asks for detectors at frequencies higher than this maximum, a version of the input signal which has been modulated down is sent to these detectors and the characteristic frequencies are adjusted suitably.</p>
<p>For each detector, a <a class="el" href="structDetectorBank_1_1detector__components.html" title="Metaparameters for a detector. ">DetectorBank::detector_components</a> structure is created, which contains the user-specifed input frequency, the characteristic frequency which will actually be used (i.e. the adjusted frequency, or, if no modulation is required, the specified frequency) and the version of the input signal which is to be used by that detector. A vector (DetectorBank::db_components) stores each detector's detector_components struct. This vector is managed by DetectorBank::set_db_components which must be invoked explictly whenever the input buffer is changed (as it is by, for example, <a class="el" href="classDetectorBank.html#aa441ae894a5df343a51777f3219e9b3b" title="Change the input, without recreating the detector bank. ">DetectorBank::setInputBuffer</a>) so that the frequency-shifted versions of the new input signal can be generated.</p>
<p>Frequency shifting can be achieved by generating a double sideband (DSB) modulated signal, then subtracting a version of the signal with a 90 \(^{\circ}\) phase shift applied. This leaves only the upper sideband (i.e. a single sideband (SSB) signal). The diagram below shows how a signal, \(g(t)\), frequency-shifted by \(\omega_c / 2\pi\) Hz, is generated from the input signal, \(f(t)\), the phase-shifted signal and the sine and cosine of the desired shifting frequency.</p>
<div class="image">
<img src="ssb_modulation.png" alt="ssb_modulation.png" height="250cm"/>
<div class="caption">
Implementation of frequency shifting via SSB modulation</div></div>
 <p>A 90 \(^{\circ}\) phase shift at all frequencies can be implemented with a Hilbert transform. The Hilbert transform of a real signal, \(f(t)\), can be expressed as </p><p class="formulaDsp">
\[ f_H(x) = \int_{-\infty}^{\infty} f(t) g(x-t) \; \mathrm{dt} \]
</p>
<p> where \(g(x) = - 1/\pi x\), which is simply a convolution and so can be implemented with a Finite Impulse Response (FIR) filter, which is provided by default by the <a class="el" href="classFrequencyShifter.html#a4719e771f5b74813f50978b1e4f46b0b">FrequencyShifter</a>.</p>
<p>A method of calculating the Hilbert transform using the Fast Fourier Transform is also supplied. This works by taking the FFT of the signal, setting the negative frequencies to zero then taking the inverse FFT. The result of this is known as the analytic signal: \(m_c = m_r + j m_i\), where \(m_c\) is the (complex) analytic signal, \(m_r\) is the original signal and \(m_i\) is the Hilbert transformed signal. Therefore, performing the above procedure and taking the imaginary part of the result yields the Hilbert transform of the signal.</p>
<p>However, FFTs require the signal to be windowed, so this method does not work for short input buffers, e.g. realtime input. In this situation, FIR method of calculating the Hilbert transform should be used.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SampleRates.html">A word on sample rates</a> </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
